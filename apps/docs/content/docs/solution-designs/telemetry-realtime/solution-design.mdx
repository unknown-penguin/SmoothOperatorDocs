---
title: "Solution Design"
description: "Ingest, process, and serve real-time F1 telemetry with alerts and dashboards."
index: false
---

## Purpose

Collect on-car and simulator telemetry, enrich with race context, persist to TimescaleDB, and fan-out to UI and alerts.

## Owners

- Product Manager: Valerii Tsyhanok
- Team: Telemetry Core (TEL)

## Flow Overview

Below the end-to-end flow is split into focused sequence diagrams to keep each one readable and fast to render.

### Edge Data Collection

<Diagram lang="plantuml" path="telemetry-sequence-collection.puml" />

### Cloud Ingestion

<Diagram lang="plantuml" path="telemetry-sequence-ingestion.puml" />

### Stream Processing & Enrichment

<Diagram lang="plantuml" path="telemetry-sequence-processing.puml" />

### Domain Consumers

<Diagram lang="plantuml" path="telemetry-sequence-domain-consumers.puml" />

### Real-time Fan-out

<Diagram lang="plantuml" path="telemetry-sequence-realtime.puml" />

### UI Updates

<Diagram lang="plantuml" path="telemetry-sequence-ui-updates.puml" />

### Read Model & Queries

<Diagram lang="plantuml" path="telemetry-sequence-read-model.puml" />

### Alerting

<Diagram lang="plantuml" path="telemetry-sequence-alerting.puml" />

### Race Control

<Diagram lang="plantuml" path="telemetry-sequence-race-control.puml" />

### Auth Token Refresh

<Diagram lang="plantuml" path="telemetry-sequence-auth-refresh.puml" />

### Monitoring & Resilience

<Diagram lang="plantuml" path="telemetry-sequence-monitoring-resilience.puml" />

## Scope

### In Scope

- MQTT ingestion and normalization
- Context merge (weather/flags)
- Enrichment, anomaly detection
- Realtime fan-out (WS/SSE)

### Out of Scope

- Historical ML model training
- Mobile offline mode

## Risks & Solution

### Technical Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| Kafka back-pressure | High | Consumer lag alerts + autoscaling |
| Hot partitions per carId | Medium | Key by (sessionId, carId) |
| DB write spikes | High | Batch writes + backoff + buffering |

### Stability Concerns

- DLQ for poison messages
- Circuit breakers to DB/Redis

### User Communication

- Live status banner for degraded realtime
- Data freshness indicators

## Research

### Research Findings

- Timescale compression reduces storage >60%
- Centrifugo handles >50k fan-out clients

### POC Results

- End-to-end p95 < 300 ms at 5k msg/s
- UI frame updates ~20 Hz without jank

## Additional Requirements

### Backend

- Schema registry and versioning
- Idempotent Kafka producers

### Frontend

- Virtualized time-series tables
- Latency and freshness badges

### Cocoa

- Low-power mode for telemetry stream
- Background refresh throttling

### QA

- Replay tests from captured sessions
- Chaos tests (broker/DB down)

## Additional Documentation

- JIRA: TEL-873
- Design: Telemetry UI mocks
- ADR: ADR-021 Kafka Partitioning
