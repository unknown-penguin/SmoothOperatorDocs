---
title: C2 - Container Diagram
description: Optimized layout of the F1 Telemetry Platform container architecture
---

## Container Diagram (C2) - Professional Layout
%% C2 – Container Diagram (C4 Model) – F1 Telemetry Platform
%% Readable, layered, left-to-right; straight lines; essential flows only


<Diagram lang="mermaid" chart={`
%%{init: {'theme':'base', 'flowchart': { 'curve': 'linear' }, 'themeVariables': { 'fontSize':'14px', 'fontFamily':'Arial'}}}%%
flowchart LR

%% ===== Lanes / Layers =====
subgraph ExtDevices["External Devices"]
  Car["Race Car"]
  Sim["ECU Simulator"]
end

subgraph ExtProviders["External Providers"]
  RaceProv["Race Data Provider\n(weather, flags, positions)"]
end

subgraph SecurityEdge["Security Edge"]
  APIGW["API Gateway / WAF"]
end

subgraph Ingestion["Ingestion"]
  MQTT["MQTT Broker (infra)"]
  Ingest["Ingestion Service (Go)"]
end

subgraph StreamingCore["Streaming Core"]
  Kafka["Kafka Cluster (infra)"]
  TopicRaw["topic: telemetry.raw.v1"]
  TopicCtx["topic: telemetry.context.v1"]
  TopicEnr["topic: telemetry.enriched.v1"]
end

subgraph ProcessingStorage["Processing and Storage"]
  Proc["Telemetry Processor and API (.NET)"]
  TS["TimescaleDB on PostgreSQL (infra)"]
  Redis["Redis Cache (infra)"]
end

subgraph Services["Domain Services"]
  Monitor["Monitoring Service (.NET)"]
  Alert["Alert Service (.NET)"]
  RaceCtrl["Race Control Service (.NET)"]
  Auth["Auth Service (.NET)"]
end

subgraph RealtimeUI["Realtime and UI"]
  RT["Realtime Gateway WS/SSE (Go)"]
  Web["Web Frontend (React + TypeScript)"]
end

subgraph AdminOps["Admin and Ops"]
  Obs["Observability (Prometheus, Grafana, Loki)"]
  Archive["Archive Storage (object store)"]
  Notify["Notifications (Slack, PagerDuty, Email)"]
end

%% ===== Primary flows =====
Car -->|"MQTT telemetry/*"| MQTT
Sim -->|"MQTT telemetry/*"| MQTT

RaceProv -->|"HTTP/JSON or gRPC"| Ingest

APIGW --> Ingest
APIGW --> Web
Web --> APIGW

MQTT -->|"subscribe and normalize"| Ingest
Ingest -->|"produce"| TopicRaw
Ingest -->|"produce"| TopicCtx
TopicRaw --> Kafka
TopicCtx --> Kafka

Kafka -->|"consume raw and context"| Proc
Proc -->|"persist"| TS
Proc -->|"produce enriched"| TopicEnr
TopicEnr --> Kafka

Kafka -->|"consume enriched"| Monitor
Kafka -->|"consume enriched"| Alert
Kafka -->|"consume enriched"| RaceCtrl
Kafka -->|"consume enriched"| RT

Monitor -. "read" .-> TS
Monitor -. "read" .-> Redis
RT --> Redis
RT --> Web
Monitor -->|"HTTP JSON (query API)"| Web

Web -->|"JWT login and refresh"| Auth
Monitor -->|"RBAC check"| Auth
Alert -->|"RBAC check"| Auth
RaceCtrl -->|"RBAC check"| Auth

RaceCtrl -->|"commands API"| Web
RaceCtrl -->|"publish commands"| Kafka

%% Ops
Proc --> Obs
Ingest --> Obs
RT --> Obs
Monitor --> Obs
Alert --> Obs
RaceCtrl --> Obs
Auth --> Obs

Proc -->|"periodic exports"| Archive
Monitor -->|"periodic exports"| Archive
Alert -->|"notify incidents"| Notify

%% ===== Classes & Colors =====
classDef go fill:#0ea5e9,stroke:#0369a1,color:#ffffff;
classDef dotnet fill:#8b5cf6,stroke:#5b21b6,color:#ffffff;
classDef infra fill:#374151,stroke:#111827,color:#ffffff;
classDef frontend fill:#10b981,stroke:#065f46,color:#ffffff;
classDef ext fill:#6b7280,stroke:#374151,color:#ffffff;

class Ingest,RT go;
class Proc,Monitor,Alert,RaceCtrl,Auth dotnet;
class MQTT,Kafka,TS,Redis infra;
class Web frontend;
class Car,Sim,RaceProv,APIGW ext;

`} />
- **Scalable** - add components without clutter
